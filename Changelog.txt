# Changelog

N-body.py от 20.05.2018.

Изменения:
Основные вычислительные фунцкии вынесены в библиотеку .pyd при помощи cython.
Благодаря этому, в разы уменьшилось время обработки одного временного шага.

======================================================

N-body.py от 19.05.2018.

Изменения:
1) Вся вычислительная часть перенесена в tree_code_multiprocessing
2) Исправлены некоторые ошибки в отображении телеметрии
3) Теперь несколько графиков выводится на одно изображение
для случаев, когда нужно сравнить потенциальную и кинетическую энергии

======================================================

N-body.py от 17.05.2018.

Изменения:
1) Добавлена функция для генерации эллипсоида
2) Исправлено несколько багов в отображении телеметрии
3) Расширено количество вводимых параметров

======================================================

N-body.py от 15.05.2018.

Изменения:
1) Доработан ручной ввод параметров.
2) Добавлена телеметрия для отслеживания состояния системы.
3) (Временно ?) отключен расчет дипольного вклада

======================================================

N-body.py от 12.05.2018.

Изменения:
1) исправлены ошибки в рассчете квадрупольного вклада.
2) добавлены функции для определения энергии системы и ее импульса.
3) добавлена система загрузки нужной конфигурации системы.
4) задать параметры системы теперь можно через консоль, вручную.
5) переработана логика работы функции branch_to_leafes.
6) добавлена возможность распараллелить процесс вычисления на 
несколько процессов.
7) добавлены функции, завершающие работу программы, если
какой-либо физический параметр получает неприемлимое для
испоользуемой модели значение.
8) раздел с физическими константами и параметрами программы
был перенесен и теперь находится между используемыми функциями
и основным кодом.
9) добавлена функция, "смягчающая" гравитационное
взаимодействие на близких дистанциях (smooth_distance).

======================================================

N-body.py от 24.04.2018.

Изменения:
Подробно: добавлен рассчет квадрупольного вклада, изменена
структура матрицы, содержащей параметры ячеек.

Теперь в строке, соответствующей одной ячейке, содержатся
следующие параметры:

[x(ЦМ), y(ЦМ), z(ЦМ), x(ГЦ), y(ГЦ), z(ГЦ), m, D(xy), D(xz), D(yz), L, N_axis,
N[0]/N_min, N[1]/N_max, N[2], N[3], N[4], N[5], N[6], N[7]]

ЦМ - центр масс

ГЦ - геометрический центр ячейки

m - масса

D(xy), D(xz), D(yz) - квадрупольные моменты

L - критерий раскрываемости ячейки

N_axis - число ячеек по одной оси

N[0]--N[7] - номера ячеек меньшего объема, из которых состоит
рассматриваемая ячейка

N_min - минимальный номер частицы, находящейся в рассматриваемой ячейке

N_max - максимальный номер частицы, находящейся в рассматриваемой ячейке

======================================================

N-body.py от 15.04.2018.

Изменения:
В двух словах: полностью переработан алгоритм, отвечающий
за обработку взаимодействия частиц с ячейками. Изменен критерий
раскрываемости ячейки. Мелкие правки, направленные на улучшение
производительности.

Подробно:
Теперь частицы, находящиеся на гранях куба с координатой по
какой-либо оси n * Distance, обрабатываются корректно.

Координата центра масс ячейки теперь вычисляется, если в ячейке
есть хотя бы одна частица.

Теперь номера подъячеек определяются сразу, в момент создания
ячейки большего размера.

Изменен критерий для раскрытия ячеек, теперь взаимодействие
частиц-ячейка считается, если растояние между центрами ячеек
больше или равно двум длинам ячейки такого же размера.
(Теперь обе ячейки, как та, в которой находятся частицы, так
и та, с которой считается взаимодействие, должны быть одного
объема)

Изменен алгоритм прохождения "дерева", теперь рассматриваются
два параллельных прохода, один определяет ячейку, в которой
находятся рассматриваемые частицы, второй определяет ячейку,
которая гравитационно взаимодействует с рассматриваемыми частицами.

======================================================

N-body.py от 13.04.2018.

Изменения:
В двух словах: изменен критерий "открытия" ячейки,
переработан код, определяющий ускорение частицы,
в качестве задела на будущее все параметры переведены в
единицы, характерные для исследуемой системы (пока что
только в закомментированном виде).

Подробно:
Теперь критерий раскрываемости ячейки применяется не только
для одной частицы, но и для всех частиц в той же ячейке

Критерий раскрываемости ячейки изменен со сферы, радиусом
в sqrt(3) * (длина ячейки) на определение, является ли
ячейка соседней.

Теперь ускорение для всех частиц в ячейке считается одновременно

======================================================

N-body.py от 09.04.2018.

Изменения:
В двух словах: небольшая переработка кода, направленная на 
улучшение быстродейтсвия.

Подробно:
Теперь строка в матрице, где хранятся параметры каждой 
частицы имеет вид:

[x, y, z, v_x, v_y, v_z, m, a_x, a_y, a_z, cell_number]

Изменены функции, отвечающие за расчет гравитационного 
взаимодействия: убраны лишние переменные и массивы, 
гравитационная постоянная вынесена в функцию interaction,

======================================================

N-body.py от 05.04.2018.

Изменения:
В двух словах: исправлена целая серия багов, которые присутствовали
в программе изначально, но были не заметны.

Подробно:
Теперь взаимодействие частица-частица обрабатывается корректно.

Номера подъячеек теперь хранятся в той же строке, где и 
параметры центра масс.

Исправлен баг, из-за которого не все ячейки обрабатывались.

Изменен порядок исполнения для части кода, определяющего
количество пройденных ячеек.

Метод интегрирования уравнений движения изменен на leapfrog/Verlet

======================================================

N-body.py от 03.04.2018

Изменения:
В двух словах: переработан алгоритм, отвечающий за распределение
частиц по ячейкам и вычисление параметров центров масс. В результате
существенно повысилось быстродействие всего алгоритма Tree code в
рассчете на один шаг.

Подробно:
Важные изменения:
Полностью переписана функция Tree_code_gravity(Y), разделена работа с
частицами и работа с ячейками, изменен порядок получения параметров ячеек.
Теперь параметры центра масс только самых малых ячеек находятся исходя из
параметров частиц в ячейке (новая функция Particles_to_cell.
Параметры центров масс для остальных ячеек теперь находятся из уже вложенных
ячеек (новая функция Cells_to_cell).

Изменена функция для распределения частиц по ячейкам Distribution,
теперь в она еще и сортирует частицы по номерам ячеек. Сортировка 
осуществляется встроенным в пакет numpy методом (сложность алгоритма O(N logN)).

Небольшие изменения:
В параметры частиц при генерации randomize_parameters() заранее
включают в себя номер ячейки, где частица находится (по-умолчанию "0")

Название функций для получения матрицы с параметрами частиц было изменено
с spawn_test и spawn_random на birth_test и birth_random соответственно.

В матрицу, где находятся параметры ячеек (R_final) на 4 и 5 позиции
перемещенны номера парвой частицы в ячейке и последней, соответственно.
С 7 на 3 позицию перемещена степень двойки, указывающая на число 
ячеек по одной оси.

Переработены функции Calculate_cell и Calculate_cube под новый формат
данных (включение матрицы cell_count в R_final и переход от координат
ячеек к порядковому номеру)

======================================================

N-body.py от 28.03.2018.
Первоначальная версия
